<div class="glass-bg d-flex justify-content-center align-items-center py-5">
  <div class="glass-card rounded-4 p-4" style="width: 100%; max-width: 700px;">
    
    <!-- Title -->
    <h4 class="text-center fw-bold mb-4 text-info small">Manage Hospitals</h4>

    <!-- Create Hospital Form -->
    <form [formGroup]="itemForm" (ngSubmit)="onSubmit()">
  <div class="d-flex gap-3 align-items-center flex-wrap">
    <!-- Hospital Name -->
    <div class="flex-fill">
      <label for="name" class="form-label fw-semibold small">Hospital Name</label>
      <input id="name" formControlName="name" type="text" class="form-control form-control-sm rounded-3"
        placeholder="Enter hospital name" />
	<div *ngIf="itemForm.get('name')?.touched && itemForm.get('name')?.invalid" class="text-danger mt-1 small">
            <div *ngIf="itemForm.get('name')?.errors?.['required']">Hospital name is required.</div>
            <div *ngIf="itemForm.get('name')?.errors?.['pattern']">Only letters and spaces are allowed.</div>
            <div *ngIf="itemForm.get('name')?.errors?.['minlength']">Minimum 3 characters required.</div>
          </div>
    </div>

    <!-- Location -->
    <div class="flex-fill">
      <label for="location" class="form-label fw-semibold small">Location</label>
      <input id="location" formControlName="location" type="text" class="form-control form-control-sm rounded-3"
        placeholder="Enter location" />
	<div *ngIf="itemForm.get('location')?.touched && itemForm.get('location')?.invalid" class="text-danger mt-1 small">
            <div *ngIf="itemForm.get('location')?.errors?.['required']">Location is required.</div>
            <div *ngIf="itemForm.get('location')?.errors?.['minlength']">Minimum 3 characters required.</div>
          </div>
    </div>

    <!-- Add Button -->
    <div style="width: 120px;">
      <label class="form-label invisible">Add</label>
      <button type="submit" class="btn btn-info text-white fw-semibold btn-sm rounded-3 w-100"
        [disabled]="itemForm.invalid">
        Add
      </button>
    </div>
  </div>
</form>

    <!-- Alerts -->
    <div *ngIf="showError" class="alert alert-danger mt-3 small">{{ errorMessage }}</div>
    <div *ngIf="responseMessage" class="alert alert-success mt-3 small">{{ responseMessage }}</div>

    <!-- Search Section -->
    <div class="row mt-4 mb-3 g-2">
      <div class="col-md-6">
        <input type="text" class="form-control form-control-sm rounded-3"
          placeholder="Search by Hospital Name" [(ngModel)]="searchName" (ngModelChange)="currentPage=1">
      </div>
      <div class="col-md-6">
        <input type="text" class="form-control form-control-sm rounded-3"
          placeholder="Search by Location" [(ngModel)]="searchLocation" (ngModelChange)="currentPage=1">
      </div>
    </div>

    <!-- Hospital List -->
    <div class="table-responsive rounded-3 mt-3">
      <table class="table table-hover align-middle mb-0 glass-table">
        <thead class="table-light text-center small text-secondary">
          <tr>
            <th>S.No</th>
            <th (click)="sortBy('name')" style="cursor: pointer;">Hospital Name
              <span *ngIf="sortField === 'name'">{{ sortDirection === 'asc' ? '↑' : '↓' }}</span>
            </th>
            <th (click)="sortBy('location')" style="cursor: pointer;">Location
              <span *ngIf="sortField === 'location'">{{ sortDirection === 'asc' ? '↑' : '↓' }}</span>
            </th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody class="text-center small">
          <tr *ngFor="let hospital of paginatedHospitals; let i = index">
            <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
            <td class="fw-semibold">{{ hospital.name }}</td>
            <td>{{ hospital.location }}</td>
            <td>
              <button class="btn btn-outline-info btn-sm rounded-3 px-3" (click)="addEquipment(hospital)">
                <i class="bi bi-tools"></i> Assign
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <nav *ngIf="totalPages > 1" class="mt-3">
      <ul class="pagination justify-content-center mb-0 small">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="changePage(currentPage - 1)">Previous</button>
        </li>
        <li class="page-item" *ngFor="let page of [].constructor(totalPages); let i = index"
          [class.active]="currentPage === i + 1">
          <button class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="changePage(currentPage + 1)">Next</button>
        </li>
      </ul>
    </nav>

    <!-- Equipment Modal -->
    <div class="modal fade show" tabindex="-1" role="dialog" [ngClass]="{'d-block': showEquipmentForm}" *ngIf="showEquipmentForm">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content glass-card rounded-4">
          <form [formGroup]="equipmentForm" (ngSubmit)="submitEquipment()">
            <div class="modal-header bg-info text-white rounded-top-4 py-2">
              <h6 class="modal-title fw-bold small">Assign Equipment to {{ assignModel?.name }}</h6>
              <button type="button" class="btn-close btn-close-white" (click)="closeModal()"></button>
            </div>
            <div class="modal-body small">
              <div class="mb-3">
                <label for="name" class="form-label fw-semibold">Equipment Name</label>
                <input id="name" formControlName="name" type="text" class="form-control form-control-sm rounded-3"
                  placeholder="Enter equipment name" />
              </div>
              <div class="mb-3">
                <label for="description" class="form-label fw-semibold">Description</label>
                <input id="description" formControlName="description" type="text"
                  class="form-control form-control-sm rounded-3" placeholder="Enter description" />
              </div>
            </div>
            <div class="modal-footer border-0 py-2">
              <button type="submit" class="btn btn-info text-white btn-sm px-3" [disabled]="equipmentForm.invalid">
                <i class="bi bi-check-circle"></i> Assign
              </button>
              <button type="button" class="btn btn-outline-secondary btn-sm px-3" (click)="closeModal()">Cancel</button>
            </div>
          </form>
          <div *ngIf="showMessage" class="alert alert-success m-3 small">{{ showMessage }}</div>
        </div>
      </div>
    </div>

  </div>
</div>
